var __reflect=this&&this.__reflect||function(t,i,e){t.__class__=i,e?e.push(i):e=[i],t.__types__=t.__types__?e.concat(t.__types__):e},__extends=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);e.prototype=i.prototype,t.prototype=new e},__awaiter=this&&this.__awaiter||function(t,i,e,n){return new(e||(e=Promise))(function(a,s){function o(t){try{h(n.next(t))}catch(i){s(i)}}function r(t){try{h(n["throw"](t))}catch(i){s(i)}}function h(t){t.done?a(t.value):new e(function(i){i(t.value)}).then(o,r)}h((n=n.apply(t,i||[])).next())})},__generator=this&&this.__generator||function(t,i){function e(t){return function(i){return n([t,i])}}function n(e){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,s&&(o=s[2&e[0]?"return":e[0]?"throw":"next"])&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[0,o.value]),e[0]){case 0:case 1:o=e;break;case 4:return h.label++,{value:e[1],done:!1};case 5:h.label++,s=e[1],e=[0];continue;case 7:e=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===e[0]||2===e[0])){h=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){h.label=e[1];break}if(6===e[0]&&h.label<o[1]){h.label=o[1],o=e;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(e);break}o[2]&&h.ops.pop(),h.trys.pop();continue}e=i.call(t,h)}catch(n){e=[6,n],s=0}finally{a=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var a,s,o,r,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},mokuai;!function(t){var i;!function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(i=t.ConstraintDirect||(t.ConstraintDirect={}));var e;!function(t){t[t.SIMPLE=0]="SIMPLE",t[t.FF=1]="FF",t[t.NN=2]="NN"}(e=t.BODY_SHAPE_TYPE||(t.BODY_SHAPE_TYPE={}));var n;!function(t){t[t.HE_XIN=0]="HE_XIN",t[t.ZHUANG_JIA=1]="ZHUANG_JIA",t[t.WU_QI=2]="WU_QI",t[t.CAN_HAI=3]="CAN_HAI"}(n=t.MO_KUAI_TYPE||(t.MO_KUAI_TYPE={})),t.SIMPLE_SIZE=16,t.FF_SIZE=32,t.NN_SIZE=48,t.SIMPLE_SIZE_PH=.32,t.FF_SIZE_PH=.64,t.NN_SIZE_PH=.96,t.M_SIZE=[t.SIMPLE_SIZE,t.FF_SIZE,t.NN_SIZE],t.M_SIZE_PH=[t.SIMPLE_SIZE_PH,t.FF_SIZE_PH,t.NN_SIZE_PH];var a=function(t){function i(i,e,n,a){var s=t.call(this,RES.getRes(n))||this;return s.mark_number=-1,s.rm_herd=!1,s.mk_level=1,s.dk_now=1,s.relativeDistance=egret.Point.create(0,0),s.shapeType=e,s.moKuaiPost=i,s.fc=a,s.initAnch(),s}return __extends(i,t),i.prototype.initAnch=function(){this.anchorOffsetX=.5*this.width,this.anchorOffsetY=.5*this.height},i.prototype.UpdataPosition=function(t){this.x=t.x+this.relativeDistance.x,this.y=t.y+this.relativeDistance.y},i.prototype.updata=function(){},i.prototype.coll=function(t){return this.dk_now=this.dk_now-t,this.dk_now<=0&&(this.mk_level--,this.mk_level>0&&(4==this.mk_level&&(this.texture=RES.getRes("zj_level_4_png")),3==this.mk_level&&(this.texture=RES.getRes("zj_level_3_png")),2==this.mk_level&&(this.texture=RES.getRes("zj_level_2_png")),1==this.mk_level&&(this.texture=RES.getRes("zj_level_1_png"))),this.dk_now=this.mk_level),this.mk_level<=0&&this.dk_now<=0?!0:!1},i.prototype.setMkLevel=function(t){this.mk_level=t,this.dk_now=t},i}(egret.Bitmap);t.MoKuaiBase=a,__reflect(a.prototype,"mokuai.MoKuaiBase")}(mokuai||(mokuai={}));var wuqi;!function(t){var i;!function(t){t[t.PU_TONG=0]="PU_TONG",t[t.ZHI_SHE=1]="ZHI_SHE",t[t.JI_GUANG=2]="JI_GUANG",t[t.DAO_DAN=3]="DAO_DAN",t[t.DA_PAO=4]="DA_PAO",t[t.ZHI_DAO_JI_GUANG=5]="ZHI_DAO_JI_GUANG",t[t.CHUAN_JIA_DAN=6]="CHUAN_JIA_DAN",t[t.YUN_BAO_DAN=7]="YUN_BAO_DAN",t[t.DING_WEI=8]="DING_WEI",t[t.JIAN_SU=9]="JIAN_SU",t[t.KAI_HUA=10]="KAI_HUA",t[t.GEN_ZHONG=11]="GEN_ZHONG"}(i=t.WUQI_TYPE||(t.WUQI_TYPE={}));var e=function(t){function e(i,e,n,a,s){var o=t.call(this,i,e,n,s)||this;return o.cd=500,o.mark_time=0,o.sudu=5,o.moKuaiType=mokuai.MO_KUAI_TYPE.WU_QI,o.wuqi_type=a,o}return __extends(e,t),e.prototype.updata_wq=function(i,e,n){return t.prototype.updata.call(this),n-this.mark_time>this.cd?(this.mark_time=n,void this.fashe(i,e,n)):void 0},e.prototype.fashe=function(t,i,e){},e.prototype.diu=function(t,e,n,a){var s;t==i.ZHI_SHE&&(s=new zidan.ZhiSheZhiDan(n,.001)),t==i.DING_WEI&&(s=new zidan.DingWeiZidan(n,1e-4)),t==i.JIAN_SU&&(s=new zidan.JianSuZiDan(n,1e-4)),t==i.KAI_HUA&&(s=new zidan.KaiHuaZiDan(n,1e-4)),t==i.GEN_ZHONG&&(s=new zidan.GenZongZiDan(n,1e-4,this.fc.battle_scene.sk)),s.angle=a,this.fc.battle_scene.world.addBody(s),this.fc.battle_scene.addChild(s.bitmap);var o=Tools.egretTOp2(egret.Point.create(this.x,this.y));s.position[0]=o.x,s.position[1]=o.y,s.velocity=[e.x,e.y]},e}(mokuai.MoKuaiBase);t.WuQiBase=e,__reflect(e.prototype,"wuqi.WuQiBase")}(wuqi||(wuqi={}));var zhuangtaiji;!function(t){var i;!function(t){t[t.SINGO_MOVE_ING=0]="SINGO_MOVE_ING",t[t.SINGO_MOVE_OVER=1]="SINGO_MOVE_OVER",t[t.ZUO_YOU_MOVE=2]="ZUO_YOU_MOVE",t[t.MOVE_OVER=3]="MOVE_OVER",t[t.NULL_T=4]="NULL_T"}(i=t.ZT_TYPE||(t.ZT_TYPE={}));var e=function(){function t(){}return t.prototype.upStep=function(t){},t}();t.ZhuangTaiJiBase=e,__reflect(e.prototype,"zhuangtaiji.ZhuangTaiJiBase")}(zhuangtaiji||(zhuangtaiji={}));var zidan;!function(t){var i=function(t){function i(i,e,n){var a=t.call(this,{mass:e})||this;return a.is_updata=!1,a.collNumber=1,a.hitNumber=1,a.is_first=!0,a.mark_time=egret.getTimer(),a.zhenying=i,a.wqt=n,a.initColl(),a.initZidan(),a}return __extends(i,t),i.prototype.initZidan=function(){var t=new p2.Box({width:mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE],height:mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE]});this.addShape(t),t.collisionMask=this.collMask,t.collisionGroup=this.collGroup},i.prototype.initColl=function(){this.zhenying==GameConstant.ZHEN_YING.WO_JUN_ZIDAN&&(this.collGroup=GameConstant.WO_JUN_ZIDAN,this.collMask=GameConstant.DI_JUN|GameConstant.ZHONG_LI),this.zhenying==GameConstant.ZHEN_YING.DI_JUN_ZIDAN&&(this.collGroup=GameConstant.DI_JUN_ZIDAN,this.collMask=GameConstant.WO_JUN|GameConstant.ZHONG_LI),this.zhenying==GameConstant.ZHEN_YING.ZHONG_LI&&(this.collGroup=GameConstant.ZHONG_LI,this.collMask=GameConstant.DI_JUN|GameConstant.ZHONG_LI|GameConstant.WO_JUN|GameConstant.WO_JUN_ZIDAN|GameConstant.DI_JUN_ZIDAN)},i.prototype.updata=function(){},i}(p2.Body);t.ZiDanBase=i,__reflect(i.prototype,"zidan.ZiDanBase")}(zidan||(zidan={}));var ai;!function(t){var i;!function(t){t[t.xuan_zhuan=0]="xuan_zhuan",t[t.miao_zhun=1]="miao_zhun"}(i=t.AI_TYPE||(t.AI_TYPE={}));var e;!function(t){t[t.ZS=0]="ZS",t[t.ZX=1]="ZX",t[t.YS=2]="YS",t[t.YX=3]="YX"}(e=t.WEI_ZHI||(t.WEI_ZHI={}));var n;!function(t){t[t.Clockwise=0]="Clockwise",t[t.Anti_clockwise=1]="Anti_clockwise"}(n=t.ZHUAN_XIANG||(t.ZHUAN_XIANG={}));var a=function(){function t(t){this.hang_up=!1,this.jian_ge=500,this.mark_time=0,this.fc=t,this.sceneConsole=t.battle_scene,this.suke=this.sceneConsole.sk}return t.prototype.updata_ai=function(t){t-this.mark_time>this.jian_ge&&(this.mark_time=t,this.doUpData(t))},t.prototype.doUpData=function(t){},t}();t.AiBase=a,__reflect(a.prototype,"ai.AiBase")}(ai||(ai={}));var feichuan;!function(t){var i;!function(t){t[t.SUKE=0]="SUKE",t[t.DIJI=1]="DIJI",t[t.CANHAI=2]="CANHAI"}(i=t.FC_TYPE||(t.FC_TYPE={}));var e=function(t){function i(i,e,n){var a=t.call(this,{mass:1})||this;return a.mokuai_size=0,a.heXinList=new Array,a.zhuangJaList=new Array,a.ais=new Array,a.egretWorldPoint=e,a.battle_scene=i,a.zhenying=n,a.initPhPost(),a.initColl(),a.ztj=new fjztj.XBZhuangtaiji(a),a}return __extends(i,t),i.prototype.initJson=function(t){var i=RES.getRes(t);this.W=i.layers[0].width,this.H=i.layers[0].height,this.initList(this.H,this.W);var e=i.layers[0].data;this.moKuaiList=new Array(this.H);for(var n=0,a=0;a<this.H;a++){this.moKuaiList[a]=new Array(this.W);for(var s=0;s<this.W;s++)if(0!=e[n]){var o=i.tiles[e[n]-1].image.replace(".","_"),r=void 0;("hx_1_png"==o||"hx_2_png"==o)&&(r=new mokuai.DongLiHeXin(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),this.hx=r),"zj_level_4_png"==o&&(r=new zhuangjia.PuTongZhuangJia(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),r.setMkLevel(4)),"zj_level_3_png"==o&&(r=new zhuangjia.PuTongZhuangJia(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),r.setMkLevel(3)),"zj_level_2_png"==o&&(r=new zhuangjia.PuTongZhuangJia(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),r.setMkLevel(2)),"zj_level_1_png"==o&&(r=new zhuangjia.PuTongZhuangJia(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),r.setMkLevel(1)),"wq_2_png"==o&&(r=new djwq.ZhiSheWuQi(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),this.wuqiList.push(r)),"wq_1_png"==o&&(r=new djwq.DingWeiWuqi(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),this.wuqiList.push(r)),"wq_3_png"==o&&(r=new djwq.GenZhongWuqi(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),this.wuqiList.push(r)),"wq_4_png"==o&&(r=new djwq.JianSuWuqi(egret.Point.create(s,a),mokuai.BODY_SHAPE_TYPE.SIMPLE,o,this),this.wuqiList.push(r));var h=Physics.getRelativeDistance(egret.Point.create(this.W,this.H),egret.Point.create(s,a),mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE]),u=new p2.Box({width:mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE],height:mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE]});u.collisionGroup=this.collGroup,u.collisionMask=this.collMask,this.addShape(u,[h.x,h.y]),this.moKuaiList[a][s]=r,r.boxShape=u,this.battle_scene.addChild(r),this.mokuai_size++,n++}else n++}this.battle_scene.world.addBody(this)},i.prototype.initColl=function(){this.zhenying==GameConstant.ZHEN_YING.WO_JUN&&(this.collGroup=GameConstant.WO_JUN,this.collMask=GameConstant.DI_JUN|GameConstant.ZHONG_LI|GameConstant.DI_JUN_ZIDAN),this.zhenying==GameConstant.ZHEN_YING.DI_JUN&&(this.collGroup=GameConstant.DI_JUN,this.collMask=GameConstant.WO_JUN|GameConstant.ZHONG_LI|GameConstant.WO_JUN_ZIDAN|GameConstant.DI_JUN),this.zhenying==GameConstant.ZHEN_YING.ZHONG_LI&&(this.collGroup=GameConstant.ZHONG_LI,this.collMask=GameConstant.DI_JUN|GameConstant.ZHONG_LI|GameConstant.WO_JUN|GameConstant.WO_JUN_ZIDAN|GameConstant.DI_JUN_ZIDAN)},i.prototype.initPhPost=function(){var t=Tools.egretTOp2(this.egretWorldPoint);this.position[0]=t.x,this.position[1]=t.y},i.prototype.initList=function(t,i){this.moKuaiList=new Array;for(var e=0;t>e;e++)this.moKuaiList.push(new Array(i));this.wuqiList=new Array,this.removeMoKuai=new Array},i.prototype.updataFenJie=function(){this.fen_jie=new Array;for(var t=0;10>t;t++)this.fen_jie.push([])},i.prototype.updataPos=function(){var t=this.moKuaiList.length,i=this.moKuaiList[0].length;this instanceof shuke.ShuKe&&(this.angle=0);for(var e=0;t>e;e++)for(var n=0;i>n;n++)if(this.moKuaiList[e][n]){var a=this.moKuaiList[e][n].boxShape,s=this.moKuaiList[e][n],o=Math.PI/180*360-this.angle,r=Math.cos(o)*a.position[0]+Math.sin(o)*a.position[1],h=-Math.sin(o)*a.position[0]+Math.cos(o)*a.position[1],u=Tools.p2TOegretPoitn(egret.Point.create(r+this.position[0],h+this.position[1]));s.x=u.x,s.y=u.y,s.markPoint=u,s.rotation=360-180*this.angle/Math.PI}},i.prototype.updataSomeThing=function(){this.updataPos(),this.updataAI(),this.updataZTJ()},i.prototype.updataZTJ=function(){this.ztj&&this.ztj.upStep(egret.getTimer())},i.prototype.updataAI=function(){this.moveAI&&this.moveAI.updata_ai(egret.getTimer()),this.xzAI&&this.xzAI.updata_ai(egret.getTimer()),this.mzAI&&this.mzAI.updata_ai(egret.getTimer())},i.prototype.getMokWorldpos=function(t){var i=Math.PI/180*360-this.angle,e=Math.cos(i)*t.x+Math.sin(i)*t.y,n=-Math.sin(i)*t.x+Math.cos(i)*t.y;return egret.Point.create(e+this.position[0],n+this.position[1])},i.prototype.initPro=function(t){var i=egret.Point.create(t[0].length,t.length);this.initList(t.length,t[0].length);for(var e=0;e<t.length;e++)for(var n=0;n<t[0].length;n++)this.initMokuai(t[e][n],e,n,i);this.battle_scene.world.addBody(this)},i.prototype.initMokuai=function(t,i,e,n){var a;if(3==t){a=new wuqi.PuTongDan(egret.Point.create(e,i),mokuai.BODY_SHAPE_TYPE.SIMPLE,"lan_dian_png",wuqi.WUQI_TYPE.PU_TONG,this);var s=a;a.setMkLevel(5),this.wuqiList.push(s)}if(2==t&&(a=new zhuangjia.PuTongZhuangJia(egret.Point.create(e,i),mokuai.BODY_SHAPE_TYPE.SIMPLE,"hong_dian_png",this)),1==t&&(a=new mokuai.DongLiHeXin(egret.Point.create(e,i),mokuai.BODY_SHAPE_TYPE.SIMPLE,"huang_dian_png",this),this.hx=a),0!=t){var o=Physics.getRelativeDistance(n,egret.Point.create(e,i),mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE]),r=new p2.Box({width:mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE],height:mokuai.M_SIZE_PH[mokuai.BODY_SHAPE_TYPE.SIMPLE]});r.collisionGroup=this.collGroup,r.collisionMask=this.collMask,this.addShape(r,[o.x,o.y]),this.moKuaiList[i][e]=a,a.boxShape=r,this.battle_scene.addChild(a),this.mokuai_size++}},i.prototype.checkCollision=function(t,i,e){for(var n,a=1e3,s=1e3,o=0;o<this.moKuaiList.length;o++)for(var r=0;r<this.moKuaiList[o].length;r++){var h=this.moKuaiList[o][r];if(h){var u=Math.abs(h.x-t),_=Math.abs(h.y-i);a+s>u+_&&(a=u,s=_,n=h)}}n&&n.coll(e.hitNumber)&&(this.moKuaiList[n.moKuaiPost.y][n.moKuaiPost.x]=null,this.battle_scene.shouShangFeiChuanList.push(this),this.removeMoKuai.push(n),n instanceof mokuai.DongLiHeXin&&(this.hx=null,this.battle_scene.lastFeiJi--),n.moKuaiType==mokuai.MO_KUAI_TYPE.WU_QI&&this.removeWuQi(n))},i.prototype.dellMokuai=function(){for(var t=0;t<this.removeMoKuai.length;t++){var i=this.removeMoKuai.pop();this.moKuaiList[i.moKuaiPost.y][i.moKuaiPost.x]=null,this.removeShape(i.boxShape),this.battle_scene.removeChild(i)}},i.prototype.fenJie=function(){for(var t=this.fen_jie.length,i=0;t>i;i++){for(var e=this.fen_jie.pop(),n=(e.length,!1),a=0,s=e;a<s.length;a++){var o=s[a];o&&(n=!0)}if(n){var r=new canhai.CanHai(this,e);this.battle_scene.canHais.push(r)}}},i.prototype.addAI=function(t){this.ais.push(t)},i.prototype.removeWuQi=function(t){var i=this.wuqiList.indexOf(t);this.wuqiList.splice(i,1)},i.prototype.ji_guang_peng_zhuang=function(t,i){},i}(p2.Body);t.FeiChuanBase=e,__reflect(e.prototype,"feichuan.FeiChuanBase")}(feichuan||(feichuan={}));var zhuangjia;!function(t){var i=function(t){function i(i,e,n,a){var s=t.call(this,i,e,n,a)||this;return s.moKuaiType=mokuai.MO_KUAI_TYPE.ZHUANG_JIA,s}return __extends(i,t),i}(mokuai.MoKuaiBase);t.ZhuangJiaBase=i,__reflect(i.prototype,"zhuangjia.ZhuangJiaBase")}(zhuangjia||(zhuangjia={}));var scene;!function(t){t.battle_sceneW=4e3,t.battle_sceneH=4e3,t.scene_anch_x=1e3,t.scene_anch_y=1e3,t.scene_wy_limit=200,t.scene_wy_bfb=.2,t.p2_zuo=20,t.p2_shang=60,t.p2_you=32,t.p2_xia=37;var i=function(i){function e(){var t=i.call(this)||this;return t.p2_wy_x=0,t.p2_wy_y=0,t.nowBo=0,t.nowHeiHe=0,t.allHeiHe=0,t.lastFeiJi=0,t.add_hh_fc=!0,t._distance=new egret.Point,t._skP=new egret.Point,t.init(),t.initcoll(),t}return __extends(e,i),e.prototype.init=function(){this.width=t.battle_sceneW,this.height=t.battle_sceneH,this.world=new p2.World,this.world.gravity=[0,0],this.addShuKeListener(),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.dijis=new Array,this.removeZiDanBodyList=new Array,this.shouShangFeiChuanList=new Array,this.canHais=new Array,this.zidanList=new Array},e.prototype.initcoll=function(){var t=this;this.world.on("beginContact",function(i){if(i.bodyB instanceof zidan.ZiDanBase||i.bodyA instanceof zidan.ZiDanBase){if(i.bodyB instanceof zidan.ZiDanBase||i.bodyA instanceof zidan.ZiDanBase){var e=i.bodyB instanceof zidan.ZiDanBase?i.bodyB:i.bodyA,n=e;n.collNumber--}if(i.bodyB instanceof feichuan.FeiChuanBase||i.bodyA instanceof feichuan.FeiChuanBase){var e=i.bodyB instanceof feichuan.FeiChuanBase?i.bodyB:i.bodyA,a=i.bodyB instanceof feichuan.FeiChuanBase?i.bodyA:i.bodyB,s=a,o=e;(o.zhenying==GameConstant.ZHEN_YING.DI_JUN||o.zhenying==GameConstant.ZHEN_YING.ZHONG_LI)&&a instanceof zidan.ZiDanBase&&s.is_first&&(o.checkCollision(a.displays[0].x,a.displays[0].y,s),s.is_first=!1),0==s.collNumber&&t.removeZiDanBodyList.push(s)}}})},e.prototype.onEnterFrame=function(){this.chackColl(),this.chackFeiChuan(),this.p2Updata(),this.upSomeThing(),this.updataIsInWorld(),this.updataWuQi()},e.prototype.updataZidan=function(){for(var t=0,i=this.zidanList;t<i.length;t++){var e=i[t];e.is_updata&&e.updata()}},e.prototype.updataWuQi=function(){for(var t=egret.getTimer(),i=0,e=this.dijis;i<e.length;i++)for(var n=e[i],a=0,s=0,o=n.wuqiList;s<o.length;s++){var r=o[s];r&&(a++,r.updata_wq(n.angle,this.sk,t))}},e.prototype.updataIsInWorld=function(){for(var t=0,i=this.canHais;t<i.length;t++){var e=i[t];e.position[1]<30&&this.removeTheFcInTheGame(e)}},e.prototype.upSomeThing=function(){},e.prototype.chackColl=function(){for(var t=this.removeZiDanBodyList.length,i=0;t>i;i++){var e=this.removeZiDanBodyList.pop();if(e){var n=e;if(n.collNumber<=0){var a=n.displays[0];a&&a.parent&&this.removeChild(a),this.world.removeBody(n),n=null}}}},e.prototype.chackFeiChuan=function(){for(var t=0;t<this.shouShangFeiChuanList.length;t++){for(var i=this.shouShangFeiChuanList.pop(),e=0;e<i.removeMoKuai.length;e++){var n=i.removeMoKuai.pop();i.removeShape(n.boxShape),this.removeChild(n),i.mokuai_size--}if(!GameConstant.chackMoKuaiNumber(i))return;GameConstant.diaoluo(i),i&&i.mokuai_size>0&&i.fenJie()}},e.prototype.p2Updata=function(){this.updataSKNow(),this.world.step(.06);for(var i=this.world.bodies.length,e=0;i>e;e++){var n=this.world.bodies[e];if(!this.sk_p2_now||n instanceof shuke.ShuKe||(n.position[0]=n.position[0]+this.sk_p2_now.x,n.position[1]=n.position[1]+this.sk_p2_now.y),n instanceof shuke.ShuKe)for(var a=n,s=0,o=a.wuqiList;s<o.length;s++){var r=o[s];r.updata_wq(n.angle,this.sk,egret.getTimer())}if(n instanceof zidan.ZiDanBase){var h=n;h.is_updata&&h.updata(),h.position[1]>t.p2_shang&&this.removeZiDanBodyList.push(h),h.position[1]<t.p2_xia&&this.removeZiDanBodyList.push(h),h.position[0]>t.p2_you&&this.removeZiDanBodyList.push(h),h.position[0]<t.p2_zuo&&this.removeZiDanBodyList.push(h),egret.getTimer()-h.mark_time>15e3&&this.removeZiDanBodyList.push(h)}if(n instanceof canhai.CanHai,n instanceof feichuan.FeiChuanBase){var u=n;u.updataSomeThing()}else{var _=n.displays[0];if(_){var c=Tools.p2TOegretPoitn(egret.Point.create(n.position[0],n.position[1]));_.x=c.x,_.y=c.y,_.rotation=360-180*n.angle/Math.PI}}}this.updataSKBefor()},e.prototype.updataSKBefor=function(){return this.sk_p2_befor?(this.sk_p2_befor.x=this.sk.position[0],void(this.sk_p2_befor.y=this.sk.position[1])):void(this.sk_p2_befor=egret.Point.create(this.sk.position[0],this.sk.position[1]))},e.prototype.updataSKNow=function(){this.sk_p2_befor&&(this.sk_p2_now||(this.sk_p2_now=egret.Point.create(0,0)),this.sk_p2_now.x=.1*(this.sk_p2_befor.x-this.sk.position[0]),this.sk_p2_now.y=.1*(this.sk_p2_befor.y-this.sk.position[1]))},e.prototype.addShuKeListener=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this)},e.prototype.mouseUp=function(t){this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},e.prototype.mouseDown=function(t){this._distance.x=t.stageX,this._distance.y=t.stageY,this._skP.x=this.sk.position[0],this._skP.y=this.sk.position[1],this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},e.prototype.mouseMove=function(t){var i=egret.Point.create((t.stageX-this._distance.x)/Physics.factor,-(t.stageY-this._distance.y)/Physics.factor);this.sk.position[0]=this._skP.x+i.x,this.sk.position[1]=this._skP.y+i.y},e.prototype.weiyi=function(i){var e=(t.scene_anch_x-t.scene_wy_limit,t.scene_anch_y-t.scene_wy_limit,t.scene_anch_x+t.scene_wy_limit+this.stage.stageWidth),n=(t.scene_anch_y+t.scene_wy_limit+this.stage.stageHeight,.5*this.stage.stageWidth),a=.5*this.stage.stageHeight,s=t.scene_anch_x+n,o=(t.scene_anch_y+a,0);i.x<s&&(o=this.x+(s-i.x),o=o>e?e:o,this.x=o),i.x>t.scene_anch_x+n},e.prototype.removeTheFcInTheGame=function(t){if(t.fc_type==feichuan.FC_TYPE.DIJI){var i=this.dijis.indexOf(t);this.dijis.splice(i)}if(t.fc_type==feichuan.FC_TYPE.CANHAI){var i=this.canHais.indexOf(t);this.canHais.splice(i)}var e=t.moKuaiList.length;this.world.removeBody(t);for(var n=0;e>n;n++)for(var a=t.moKuaiList[n].length,s=0;a>s;s++)t.moKuaiList[n][s]&&this.removeChild(t.moKuaiList[n][s]),t.moKuaiList[n][s]=null;t=null},e}(egret.DisplayObjectContainer);t.SceneBase=i,__reflect(i.prototype,"scene.SceneBase")}(scene||(scene={}));var djwq;!function(t){var i=function(t){function i(i,e,n,a,s){return t.call(this,e,n,a,s,i)||this}return __extends(i,t),i.prototype.fashe=function(t,i,e){},i}(wuqi.WuQiBase);t.DJWQBase=i,__reflect(i.prototype,"djwq.DJWQBase")}(djwq||(djwq={}));var fjztj;!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.upStep=function(t){},i}(zhuangtaiji.ZhuangTaiJiBase);t.FjZTJ=i,__reflect(i.prototype,"fjztj.FjZTJ")}(fjztj||(fjztj={}));var ai;!function(t){var i=function(t){function i(i){return t.call(this,i)||this}return __extends(i,t),i.prototype.doUpData=function(i){if(!this.hang_up){t.prototype.doUpData.call(this,i);var e=Math.atan2(this.suke.position[1]-this.fc.position[1],this.suke.position[0]-this.fc.position[0])+.5*Math.PI;this.fc.angle=e}},i}(t.AiBase);t.ShiShiMiaoZhunAi=i,__reflect(i.prototype,"ai.ShiShiMiaoZhunAi")}(ai||(ai={}));var ai;!function(t){var i=function(t){function i(i){var e=t.call(this,i)||this;return e.is_u=!0,e.point_index=0,e.wu_cha=1,e}return __extends(i,t),i.prototype.doUpData=function(i){if(this.fc.toPoint){t.prototype.doUpData.call(this,i);var e=egret.Point.distance(this.fc.toPoint,egret.Point.create(this.fc.position[0],this.fc.position[1]));if(e<this.wu_cha)return this.fc.toPoint=null,void(this.fc.ztj.mT=zhuangtaiji.ZT_TYPE.SINGO_MOVE_OVER);this.rx=.5*(this.fc.toPoint.x-this.fc.position[0]),this.ry=.5*(this.fc.toPoint.y-this.fc.position[1]),this.fc.velocity=[this.rx,this.ry]}},i}(t.AiBase);t.SingoMoveToAi=i,__reflect(i.prototype,"ai.SingoMoveToAi")}(ai||(ai={}));var ai;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i)||this;return n.xs=e,n}return __extends(i,t),i.prototype.doUpData=function(i){this.hang_up||(t.prototype.doUpData.call(this,i),this.fc.angularVelocity=this.xs)},i}(t.AiBase);t.XuanZhuanAI=i,__reflect(i.prototype,"ai.XuanZhuanAI")}(ai||(ai={}));var ai;!function(t){var i=function(i){function e(t){var e=i.call(this,t)||this;return e.xs=.5,e.fc.angularDamping=.9,e}return __extends(e,i),e.prototype.doUpData=function(i){if(!this.hang_up&&this.fc.p2_target){var e=Math.atan2(this.fc.p2_target.y-this.fc.position[1],this.fc.p2_target.x-this.fc.position[0])+.5*Math.PI,n=Math.PI+1.57;this.fc.angle>n&&(this.fc.angle=this.fc.angle-2*Math.PI),this.fc.angle<.5*-Math.PI&&(this.fc.angle=n),e>=0&&this.fc.angle>=0&&(Math.abs(e-this.fc.angle)<Math.PI?e<this.fc.angle?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:e<this.fc.angle?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise),0>e&&this.fc.angle>=0&&(Math.abs(e)+this.fc.angle<Math.PI?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise),this.fc.angle<0&&e>=0&&(Math.abs(e)+this.fc.angle<Math.PI?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise),this.fc.angle<0&&0>e&&(this.fc.angle<e?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise),this.xuan_zhuan_fang_xiang==t.ZHUAN_XIANG.Clockwise&&Math.abs(this.fc.angle-e)>.1&&(this.fc.angularVelocity=-this.xs),this.xuan_zhuan_fang_xiang==t.ZHUAN_XIANG.Anti_clockwise&&Math.abs(this.fc.angle-e)>.1&&(this.fc.angularVelocity=this.xs)}},e}(t.AiBase);t.ZhuanXiang=i,__reflect(i.prototype,"ai.ZhuanXiang")}(ai||(ai={}));var ai;!function(t){var i=function(t){function i(i){var e=t.call(this,i)||this;return e.is_get=!0,e.v=1,e}return __extends(i,t),i.prototype.doUpData=function(t){if(this.is_get||this.fc.velocity[0]<.5)return this.target_point=egret.Point.create(this.getRandomX(),this.fc.position[1]),this.target_point.x>this.fc.position[0]?this.fc.velocity=[this.v,0]:this.fc.velocity=[-this.v,0],void(this.is_get=!1);var i=egret.Point.distance(egret.Point.create(this.fc.position[0],this.fc.position[1]),this.target_point);.5>i&&(this.is_get=!0)},i.prototype.getRandomX=function(){var t=Math.random()*(scene.p2_you-scene.p2_zuo)+scene.p2_zuo;return t},i}(t.AiBase);t.ZuoYouLuanDongAI=i,__reflect(i.prototype,"ai.ZuoYouLuanDongAI")}(ai||(ai={}));var canhai;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i.battle_scene,egret.Point.create(500,500),GameConstant.ZHEN_YING.ZHONG_LI)||this;return n.fc_type=feichuan.FC_TYPE.CANHAI,n.yuntu=e,n.zhuji=i,n.initCanhai(),n}return __extends(i,t),i.prototype.initCanhai=function(){for(var t=100,i=100,e=0,n=0,a=0,s=this.yuntu;a<s.length;a++){var o=s[a];o&&(o.moKuaiPost.x<i&&(i=o.moKuaiPost.x),o.moKuaiPost.y<t&&(t=o.moKuaiPost.y),o.moKuaiPost.x>e&&(e=o.moKuaiPost.x),o.moKuaiPost.y>n&&(n=o.moKuaiPost.y))}for(var r=n-t+1,h=e-i+1,u=new Array,_=0;r>=_;_++){u[_]=new Array;for(var c=0;h>=c;c++)u[_].push(0)}for(var p=0,l=this.yuntu;p<l.length;p++){var o=l[p];u[o.moKuaiPost.y-t][o.moKuaiPost.x-i]=2}this.initPro(u);var f=this.yuntu[0],g=this.moKuaiList[f.moKuaiPost.y-t][f.moKuaiPost.x-i],d=Math.PI/180*360-this.zhuji.angle,m=Math.cos(d)*(f.boxShape.position[0]-g.boxShape.position[0])+Math.sin(d)*(f.boxShape.position[1]-g.boxShape.position[1]),y=-Math.sin(d)*(f.boxShape.position[0]-g.boxShape.position[0])+Math.cos(d)*(f.boxShape.position[1]-g.boxShape.position[1]);this.position[0]=this.zhuji.position[0]+m,this.position[1]=this.zhuji.position[1]+y,this.angle=this.zhuji.angle,this.velocity=[0,-5]},i.prototype.updataSomeThing=function(){t.prototype.updataSomeThing.call(this),this.velocity=[0,-1]},i}(feichuan.FeiChuanBase);t.CanHai=i,__reflect(i.prototype,"canhai.CanHai")}(canhai||(canhai={}));var GameConstant;!function(t){function i(i){i.updataFenJie();var s=i.moKuaiList;t.mark=0;var o;i.fc_type==feichuan.FC_TYPE.DIJI&&(o=i.hx,o&&(o.mark_number=t.mark)),i.fc_type==feichuan.FC_TYPE.CANHAI&&(o=e(i)),n(s,o,i),a(s,i),i.fc_type==feichuan.FC_TYPE.DIJI&&null==i.hx&&i.battle_scene.removeTheFcInTheGame(i)}function e(i){for(var e=0;e<i.moKuaiList.length;e++)for(var n=0;n<i.moKuaiList[e].length;n++)if(i.moKuaiList[e][n])return i.moKuaiList[e][n].mark_number=t.mark,i.moKuaiList[e][n]}function n(i,e,n){if(e){for(t.hearList=new Array,t.hearList.push(e);t.hearList.length>0;)o(i,t.hearList.shift(),n);for(var a=0;10>a&&s(i,n);a++);}else for(var r=0;r<i.length;r++)for(var h=0;h<i[r].length;h++)i[r][h]&&(i[r][h].mark_number=1)}function a(t,i){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)if(t[e][n]){if(t[e][n].mark_number>0){i.fen_jie[t[e][n].mark_number].push(t[e][n]),i.removeShape(t[e][n].boxShape),i.battle_scene.removeChild(t[e][n]),t[e][n]=null;continue}t[e][n].mark_number=-1}}function s(i,e){t.mark++,t.hearList=new Array;for(var n=!1,a=0;a<i.length;a++){for(var s=0;s<i[a].length;s++)if(i[a][s]&&-1==i[a][s].mark_number){i[a][s].mark_number=t.mark,t.hearList.push(i[a][s]),n=!0;break}if(n)break}for(;t.hearList.length>0;)o(i,t.hearList.shift(),e);return n}function o(i,e,n){var a,s,o=e.moKuaiPost.x,h=e.moKuaiPost.y;a=h-1,s=o,r(i,t.mark,a,s,n),a=h+1,s=o,r(i,t.mark,a,s,n),a=h,s=o-1,r(i,t.mark,a,s,n),a=h,s=o+1,r(i,t.mark,a,s,n)}function r(i,e,n,a,s){n>=0&&a>=0&&n<i.length&&a<i[0].length&&i[n][a]&&-1==i[n][a].mark_number&&(i[n][a].mark_number=e,t.hearList.push(i[n][a]))}function h(t){for(var i=!1,e=0;e<t.moKuaiList.length;e++)for(var n=0;n<t.moKuaiList[e].length;n++)t.moKuaiList[e][n]&&(i=!0);return i?!0:(t.battle_scene.removeTheFcInTheGame(t),!1)}var u;!function(t){t[t.WO_JUN=0]="WO_JUN",t[t.DI_JUN=1]="DI_JUN",t[t.ZHONG_LI=2]="ZHONG_LI",t[t.WO_JUN_ZIDAN=3]="WO_JUN_ZIDAN",t[t.DI_JUN_ZIDAN=4]="DI_JUN_ZIDAN"}(u=t.ZHEN_YING||(t.ZHEN_YING={})),t.WO_JUN=Math.pow(2,1),t.DI_JUN=Math.pow(2,2),t.ZHONG_LI=Math.pow(2,3),t.WO_JUN_ZIDAN=Math.pow(2,4),t.DI_JUN_ZIDAN=Math.pow(2,5),t.mark=0,t.diaoluo=i,t.chackMoKuaiNumber=h}(GameConstant||(GameConstant={}));var Main=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i._distance=new egret.Point,i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var i=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",i),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadResource()},i.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return e.sent(),[4,RES.loadGroup("testLoad",0,t)];case 2:return e.sent(),[4,this.stage.removeChild(t)];case 3:return e.sent(),this.addTestScene(),[3,5];case 4:return i=e.sent(),console.error(i),[3,5];case 5:return[2]}})})},i.prototype.addTestScene=function(){this.testSen=new TestScene,this.stage.addChild(this.testSen),this.testSen.x=-scene.scene_anch_x,this.testSen.y=-scene.scene_anch_y},i}(eui.UILayer);__reflect(Main.prototype,"Main");var feichuan;!function(t){var i=function(i){function e(e,n,a,s){var o=i.call(this,e,n,GameConstant.ZHEN_YING.DI_JUN)||this;return o.fc_type=t.FC_TYPE.DIJI,o.initJson(s),o.initTestFchuan(),o.toPoint=Tools.egretTOp2(a),o}return __extends(e,i),e.prototype.initTestFchuan=function(){this.angularDamping=.6,this.mass=100,this.damping=.5},e}(t.FeiChuanBase);t.XiaoBing=i,__reflect(i.prototype,"feichuan.XiaoBing")}(feichuan||(feichuan={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var zhuangjia;!function(t){var i=function(t){function i(i,e,n,a){var s=t.call(this,i,e,n,a)||this;return s.number=3,s}return __extends(i,t),i.prototype.Defense=function(){return this.markNumber--,this.markNumber<=0?!1:!0},i}(t.ZhuangJiaBase);t.PuTongZhuangJia=i,__reflect(i.prototype,"zhuangjia.PuTongZhuangJia")}(zhuangjia||(zhuangjia={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,i,e,n){function a(t){i.call(n,t)}function s(i){i.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),e.call(n))}"undefined"!=typeof generateEUI?egret.callLater(function(){i.call(n,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Guanka=function(){function t(t){this.scene=t,this.init()}return t.prototype.init=function(){this.bos=[[[{nowP:egret.Point.create(1300,800),toP:egret.Point.create(1300,1200),sName:"1_m2_json"}],[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"1_m3_json"}],[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"2_m2_json"}]],[[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"2_m3_json"}],[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"3_m2_json"}]],[[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"3_m3_json"}],[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"4_m2_json"}]],[[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"4_m3_json"}],[{nowP:egret.Point.create(1100,800),toP:egret.Point.create(1100,1200),sName:"5_m2_json"}]]]
},t}();__reflect(Guanka.prototype,"Guanka");var mokuai;!function(t){var i=function(i){function e(e,n,a,s){var o=i.call(this,e,n,a,s)||this;return o.moKuaiType=t.MO_KUAI_TYPE.HE_XIN,o}return __extends(e,i),e}(t.MoKuaiBase);t.DongLiHeXin=i,__reflect(i.prototype,"mokuai.DongLiHeXin")}(mokuai||(mokuai={}));var Physics;!function(t){function i(t,i,e){var n,a,s=i.x;n=(s-t.x/2)*e,0>n&&(n+=.5*e),n>0&&(n+=.5*e),0==n&&(n=.5*e),1==t.x&&(n=0),s-t.x/2==-.5&&(n=0);var o=t.y-i.y-1;return a=(o-t.y/2)*e,0>a&&(a+=.5*e),a>0&&(a+=.5*e),0==a&&(a=.5*e),1==t.y&&(a=0),o-t.y/2==-.5&&(a=0),egret.Point.create(n,a)}t.factor=50,t.getRelativeDistance=i}(Physics||(Physics={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,i,e){function n(n){i.call(e,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(t){function i(){var i=t.call(this)||this;return i.createView(),i}return __extends(i,t),i.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.prototype.onProgress=function(t,i){this.textField.text="Loading..."+t+"/"+i},i}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var test;!function(t){var i;!function(t){t[t.nll=0]="nll",t[t.hx=1]="hx",t[t.zj=2]="zj"}(i=t.yuntu_type||(t.yuntu_type={}));var e=function(t){function i(i){var e=t.call(this,i,egret.Point.create(1200,1300),GameConstant.ZHEN_YING.DI_JUN)||this;return e.fc_type=feichuan.FC_TYPE.DIJI,e.initJson("6_1_json"),e.initTestFchuan(),e}return __extends(i,t),i.prototype.initTestFchuan=function(){this.mass=100},i}(feichuan.FeiChuanBase);t.TestFeiChuan=e,__reflect(e.prototype,"test.TestFeiChuan")}(test||(test={}));var test;!function(t){var i=function(t){function i(){var i=t.call(this)||this;return i.drawGrid(),i}return __extends(i,t),i.prototype.drawGrid=function(){this.graphics.beginFill(0),this.graphics.drawRect(0,0,scene.battle_sceneW,scene.battle_sceneH),this.graphics.endFill(),this.graphics.lineStyle(.2,16777215);for(var t=0;t<scene.battle_sceneH/100;t++)this.graphics.moveTo(0,100*t),this.graphics.lineTo(scene.battle_sceneW,100*t);this.graphics.endFill(),this.graphics.lineStyle(.2,16777215);for(var t=0;t<scene.battle_sceneW/100;t++)this.graphics.moveTo(100*t,0),this.graphics.lineTo(100*t,scene.battle_sceneH);this.graphics.endFill()},i}(egret.Sprite);t.TestGrid=i,__reflect(i.prototype,"test.TestGrid")}(test||(test={}));var TestScene=function(t){function i(){var i=t.call(this)||this;return i.guanka=new Guanka(i),i.initTest(),i.initGuanka(),i}return __extends(i,t),i.prototype.initGuanka=function(){this.nowBo=0,this.nowHeiHe=0,this.allHeiHe=this.guanka.bos[this.nowBo].length},i.prototype.initTest=function(){var t=(egret.Point.create(1200,1200),new test.TestGrid);t.x=0,t.y=0,this.addChild(t);var i=new shuke.ShuKe(this);this.sk=i},i.prototype.upSomeThing=function(){if(t.prototype.upSomeThing.call(this),this.add_hh_fc){this.add_hh_fc=!1;for(var i=0;i<this.guanka.bos[this.nowBo][this.nowHeiHe].length;i++){var e=new feichuan.XiaoBing(this,this.guanka.bos[this.nowBo][this.nowHeiHe][i].nowP,this.guanka.bos[this.nowBo][this.nowHeiHe][i].toP,this.guanka.bos[this.nowBo][this.nowHeiHe][i].sName);this.dijis.push(e)}this.lastFeiJi=this.guanka.bos[this.nowBo][this.nowHeiHe].length,this.nowHeiHe++,this.nowHeiHe>=this.guanka.bos[this.nowBo].length&&(this.nowBo++,this.nowHeiHe=0)}this.lastFeiJi<=0&&(this.add_hh_fc=!0)},i}(scene.SceneBase);__reflect(TestScene.prototype,"TestScene");var Tools;!function(t){function i(t){return egret.Point.create(t.x*Physics.factor,scene.battle_sceneH-t.y*Physics.factor)}function e(t){return egret.Point.create(t.x/Physics.factor,(scene.battle_sceneH-t.y)/Physics.factor)}function n(t,i,e){var n,a,s=1;return 0>t&&(n=-1*e),t>0&&(n=e),0==t&&(t=.001),0==i&&(i=.001),0>i&&(a=-1*e),i>0&&(a=e),Math.abs(t)>Math.abs(i)?(s=Math.abs(i)/Math.abs(t),egret.Point.create(n,a*s)):Math.abs(i)>Math.abs(t)?(s=Math.abs(t)/Math.abs(i),egret.Point.create(n*s,a)):Math.abs(i)==Math.abs(t)?egret.Point.create(n,a):void 0}function a(t,i){var e=100*t+50,n=100*i+50;return egret.Point.create(e/Physics.factor,(scene.battle_sceneH-n)/Physics.factor)}t.p2TOegretPoitn=i,t.egretTOp2=e,t.bilv=n,t.gridTop2=a}(Tools||(Tools={}));var wuqi;!function(t){var i=function(t){function i(i,e,n,a,s){var o=t.call(this,i,e,n,a,s)||this;return o.cd=100,o}return __extends(i,t),i.prototype.fashe=function(i,e,n){t.prototype.fashe.call(this,i,e,n);var a=new zidan.PuTongZiDan(GameConstant.ZHEN_YING.WO_JUN_ZIDAN,1e-4),s=Tools.egretTOp2(egret.Point.create(this.x,this.y));a.position[0]=s.x,a.position[1]=s.y;var o=0*Math.cos(this.fc.angle)+Math.sin(this.fc.angle)*this.sudu,r=0*-Math.sin(this.fc.angle)+Math.cos(this.fc.angle)*this.sudu;this.fc.battle_scene.world.addBody(a),this.fc.battle_scene.addChild(a.bitmap),a.velocity=[o,r]},i}(t.WuQiBase);t.PuTongDan=i,__reflect(i.prototype,"wuqi.PuTongDan")}(wuqi||(wuqi={}));var ai;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i)||this;return n.xs=e,n}return __extends(i,t),i.prototype.doUpData=function(t){if(!this.hang_up){var i=egret.Point.distance(egret.Point.create(this.suke.position[0],this.suke.position[1]),egret.Point.create(this.fc.position[0],this.fc.position[1]));if(i<this.xs)return;var e=.1*(this.suke.position[0]-this.fc.position[0]),n=.1*(this.suke.position[1]-this.fc.position[1]);this.fc.velocity=[e,n]}},i}(t.AiBase);t.KeepDistanceAI=i,__reflect(i.prototype,"ai.KeepDistanceAI")}(ai||(ai={}));var djwq;!function(t){var i=function(t){function i(i,e,n,a){var s=t.call(this,a,i,e,n,wuqi.WUQI_TYPE.DING_WEI)||this;return s.cd=1e3,s}return __extends(i,t),i.prototype.fashe=function(t,i,e){var n=this.fc.angle,a=Math.sin(n)*this.sudu,s=Math.cos(n)*this.sudu;s=-1*s;var o=(-(this.fc.position[0]-i.position[0]),-(this.fc.position[1]-i.position[1]),egret.Point.create(a,s));this.diu(this.wuqi_type,o,GameConstant.ZHEN_YING.DI_JUN_ZIDAN,n)},i}(t.DJWQBase);t.DingWeiWuqi=i,__reflect(i.prototype,"djwq.DingWeiWuqi")}(djwq||(djwq={}));var ai;!function(t){var i=function(i){function e(t,e){var n=i.call(this,t)||this;return n.is_xuan_ting=!1,n.xs=e,n}return __extends(e,i),e.prototype.doUpData=function(e){if(!this.hang_up){i.prototype.doUpData.call(this,e);var n=Math.atan2(this.suke.position[1]-this.fc.position[1],this.suke.position[0]-this.fc.position[0])+.5*Math.PI,a=Math.PI+1.57;if(this.fc.angle>a&&(this.fc.angle=this.fc.angle-2*Math.PI),this.fc.angle<.5*-Math.PI&&(this.fc.angle=a),Math.abs(this.fc.angle-n)<.3)return;egret.log("YYYYYYYYYYYYYYY:"+this.fc.angle+"_____"+n+" || "+Math.abs(this.fc.angle-n)),n>=0&&this.fc.angle>=0&&(Math.abs(n-this.fc.angle)<Math.PI?n<this.fc.angle?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:n<this.fc.angle?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise),0>n&&this.fc.angle>=0&&(Math.abs(n)+this.fc.angle<Math.PI?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise),this.fc.angle<0&&n>=0&&(Math.abs(n)+this.fc.angle<Math.PI?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise),this.fc.angle<0&&0>n&&(this.fc.angle<n?this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Anti_clockwise:this.xuan_zhuan_fang_xiang=t.ZHUAN_XIANG.Clockwise),this.is_xuan_ting||(this.xuan_zhuan_fang_xiang==t.ZHUAN_XIANG.Clockwise&&(this.fc.angularVelocity=-this.xs),this.xuan_zhuan_fang_xiang==t.ZHUAN_XIANG.Anti_clockwise&&(this.fc.angularVelocity=this.xs))}},e}(t.AiBase);t.MiaoZhun=i,__reflect(i.prototype,"ai.MiaoZhun")}(ai||(ai={}));var djwq;!function(t){var i=function(t){function i(i,e,n,a){var s=t.call(this,a,i,e,n,wuqi.WUQI_TYPE.GEN_ZHONG)||this;return s.small_cd=2e3,s.mark_small_time=0,s.shu_liang=0,s.shu_liang_mark=5,s.cd=500,s.shu_liang_mark=5,s.shu_liang=s.shu_liang_mark,s.sudu=1.2,s}return __extends(i,t),i.prototype.fashe=function(t,i,e){if(e-this.mark_small_time>this.small_cd)if(this.shu_liang>0){var n=this.fc.angle,a=egret.Point.create(0,this.sudu);this.diu(this.wuqi_type,a,GameConstant.ZHEN_YING.DI_JUN_ZIDAN,n),this.shu_liang--}else this.mark_small_time=e+this.small_cd,this.shu_liang=this.shu_liang_mark},i}(t.DJWQBase);t.GenZhongWuqi=i,__reflect(i.prototype,"djwq.GenZhongWuqi")}(djwq||(djwq={}));var djwq;!function(t){var i=function(t){function i(i,e,n,a){var s=t.call(this,a,i,e,n,wuqi.WUQI_TYPE.JIAN_SU)||this;return s.cd=1e3,s.sudu=25,s}return __extends(i,t),i.prototype.fashe=function(t,i,e){var n=this.fc.angle,a=Math.sin(n)*this.sudu,s=Math.cos(n)*this.sudu;s=-1*s;var o=(-(this.fc.position[0]-i.position[0]),-(this.fc.position[1]-i.position[1]),egret.Point.create(a,s));this.diu(this.wuqi_type,o,GameConstant.ZHEN_YING.DI_JUN_ZIDAN,n)},i}(t.DJWQBase);t.JianSuWuqi=i,__reflect(i.prototype,"djwq.JianSuWuqi")}(djwq||(djwq={}));var djwq;!function(t){var i;!function(t){t[t.WU=0]="WU",t[t.ZHAO=1]="ZHAO",t[t.GONG=2]="GONG",t[t.TIAO_ZHENG=3]="TIAO_ZHENG"}(i||(i={}));var e=function(t){function e(e,n,a,s){var o=t.call(this,s,e,n,a,wuqi.WUQI_TYPE.JI_GUANG)||this;return o.kuan=10,o.G_kuan=4,o.cd=100,o.sudu=25,o.zt=i.WU,o}return __extends(e,t),e.prototype.fashe=function(t,e,n){if(this.zt!=i.TIAO_ZHENG){if(this.zt==i.WU){var a=new egret.Shape;a.graphics.lineStyle(this.kuan,16776960),a.graphics.moveTo(this.x,this.y),a.graphics.lineTo(this.x,this.y+1e3),a.graphics.endFill(),a.alpha=.5,this.fc.battle_scene.addChild(a);var s=this.fc;egret.Tween.get(a).to({alpha:.1},600).call(this.rmJG_zhao,this,[s,a]).call(this.t,this,[i.ZHAO]),this.zt=i.TIAO_ZHENG,this.fc.battle_scene.sk.ji_guang_peng_zhuang(this.x,this.y)}if(this.zt==i.ZHAO){var a=new egret.Shape;a.graphics.lineStyle(this.G_kuan,16776960),a.graphics.moveTo(this.x,this.y),a.graphics.lineTo(this.x,this.y+1e3),a.graphics.endFill(),this.fc.battle_scene.addChild(a);var s=this.fc;a.alpha=.7,egret.Tween.get(a).to({alpha:.9},400).call(this.rmJG_gong,this,[s,a]).wait(2e3).call(this.t,this,[i.WU]),this.zt=i.TIAO_ZHENG}}},e.prototype.rmJG_zhao=function(t,i){t.battle_scene.removeChild(i)},e.prototype.rmJG_gong=function(t,i){t.battle_scene.removeChild(i)},e.prototype.t=function(t){this.zt=t},e}(t.DJWQBase);t.JiGuangWuqi=e,__reflect(e.prototype,"djwq.JiGuangWuqi")}(djwq||(djwq={}));var djwq;!function(t){var i=function(t){function i(i,e,n,a){var s=t.call(this,a,i,e,n,wuqi.WUQI_TYPE.KAI_HUA)||this;return s.small_cd=2e3,s.mark_small_time=0,s.shu_liang=0,s.shu_liang_mark=5,s.cd=500,s.shu_liang_mark=5,s.shu_liang=s.shu_liang_mark,s.sudu=1.2,s}return __extends(i,t),i.prototype.fashe=function(t,i,e){if(e-this.mark_small_time>this.small_cd)if(this.shu_liang>0){var n=this.fc.angle,a=egret.Point.create(0,this.sudu);this.diu(this.wuqi_type,a,GameConstant.ZHEN_YING.DI_JUN_ZIDAN,n),this.shu_liang--}else this.mark_small_time=e+this.small_cd,this.shu_liang=this.shu_liang_mark},i}(t.DJWQBase);t.KaiHuaWuqi=i,__reflect(i.prototype,"djwq.KaiHuaWuqi")}(djwq||(djwq={}));var djwq;!function(t){var i=function(t){function i(i,e,n,a){var s=t.call(this,a,i,e,n,wuqi.WUQI_TYPE.ZHI_SHE)||this;return s.cd=1e3,s}return __extends(i,t),i.prototype.fashe=function(t,i,e){var n=Math.atan2(i.position[1]-this.fc.position[1],i.position[0]-this.fc.position[0])+.5*Math.PI,a=Math.sin(n)*this.sudu,s=Math.cos(n)*this.sudu;i.position[1]<this.fc.position[1]&&(s=-1*s);var o=(-(this.fc.position[0]-i.position[0]),-(this.fc.position[1]-i.position[1]),egret.Point.create(a,s));this.diu(this.wuqi_type,o,GameConstant.ZHEN_YING.DI_JUN_ZIDAN,n)},i}(t.DJWQBase);t.ZhiSheWuQi=i,__reflect(i.prototype,"djwq.ZhiSheWuQi")}(djwq||(djwq={}));var ai;!function(t){var i=function(t){function i(i,e,n){var a=t.call(this,i)||this;return a.is_u=!0,a.point_index=0,a.wu_cha=1,a.points=e,a.is_loop=n,a.fc.p2_target=e[0],a}return __extends(i,t),i.prototype.doUpData=function(i){if(!this.hang_up){t.prototype.doUpData.call(this,i);var e=egret.Point.distance(egret.Point.create(this.points[this.point_index].x,this.points[this.point_index].y),egret.Point.create(this.fc.position[0],this.fc.position[1]));if(e<this.wu_cha)return this.is_u=!0,this.point_index++,this.point_index>=this.points.length?this.is_loop?(this.point_index=0,void(this.fc.p2_target=this.points[this.point_index])):(this.hang_up=!0,void(this.fc.p2_target=null)):void(this.fc.p2_target=this.points[this.point_index]);if(this.is_u){Math.atan2(this.suke.position[1]-this.fc.position[1],this.suke.position[0]-this.fc.position[0]);this.rx=.1*(this.points[this.point_index].x-this.fc.position[0]),this.ry=.1*(this.points[this.point_index].y-this.fc.position[1]),this.is_u=!1}this.fc.velocity=[this.rx,this.ry]}},i}(t.AiBase);t.MoveToAi=i,__reflect(i.prototype,"ai.MoveToAi")}(ai||(ai={}));var duixing;!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i}(zhuangtaiji.ZhuangTaiJiBase);t.DuiXingBase=i,__reflect(i.prototype,"duixing.DuiXingBase")}(duixing||(duixing={}));var ai;!function(t){var i;!function(t){t[t.x=0]="x",t[t.y=1]="y",t[t.all=2]="all"}(i=t.RANDOM_POINT||(t.RANDOM_POINT={}));var e=function(t){function e(i,e,n){var a=t.call(this,i)||this;return a.is_u=!0,a.d_limit=n,a.random_type=e,a.r_point=a.random_p(),a}return __extends(e,t),e.prototype.doUpData=function(t){var i=egret.Point.distance(egret.Point.create(this.r_point.x,this.r_point.y),egret.Point.create(this.fc.position[0],this.fc.position[1]));if(.3>i&&(this.r_point=this.random_p(),this.is_u=!0),this.is_u){Math.atan2(this.suke.position[1]-this.fc.position[1],this.suke.position[0]-this.fc.position[0]);this.rx=.1*(this.r_point.x-this.fc.position[0]),this.ry=.1*(this.r_point.y-this.fc.position[1]),this.is_u=!1}this.fc.velocity=[this.rx,this.ry]},e.prototype.random_p=function(){var t=Math.random()*this.d_limit*2-this.d_limit,e=Math.random()*this.d_limit*2-this.d_limit;return this.random_type==i.x?egret.Point.create(this.fc.position[0]+t,this.fc.position[1]):this.random_type==i.y?egret.Point.create(this.fc.position[0],this.fc.position[1]+e):this.random_type==i.all?egret.Point.create(this.fc.position[0]+t,this.fc.position[1]+e):null},e}(t.AiBase);t.RandomPointAi=e,__reflect(e.prototype,"ai.RandomPointAi")}(ai||(ai={}));var fjztj;!function(t){var i=function(t){function i(i){var e=t.call(this)||this;return e.fc=i,e.mT=zhuangtaiji.ZT_TYPE.SINGO_MOVE_ING,e.xzT=zhuangtaiji.ZT_TYPE.NULL_T,e.mzT=zhuangtaiji.ZT_TYPE.NULL_T,e}return __extends(i,t),i.prototype.upStep=function(i){t.prototype.upStep.call(this,i),this.mT==zhuangtaiji.ZT_TYPE.SINGO_MOVE_ING&&(this.fc.moveAI||(this.fc.moveAI=new ai.SingoMoveToAi(this.fc))),this.mT==zhuangtaiji.ZT_TYPE.SINGO_MOVE_OVER&&(this.fc.moveAI&&this.fc.moveAI instanceof ai.ZuoYouLuanDongAI||(this.fc.moveAI=new ai.ZuoYouLuanDongAI(this.fc)))},i}(t.FjZTJ);t.XBZhuangtaiji=i,__reflect(i.prototype,"fjztj.XBZhuangtaiji")}(fjztj||(fjztj={}));var pici;!function(t){var i=function(t){function i(){return t.call(this)||this}return __extends(i,t),i}(zhuangtaiji.ZhuangTaiJiBase);t.PiCiBase=i,__reflect(i.prototype,"pici.PiCiBase")}(pici||(pici={}));var zidan;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i,e,wuqi.WUQI_TYPE.PU_TONG)||this;return n.initPT(),n}return __extends(i,t),i.prototype.initPT=function(){this.bitmap=new egret.Bitmap(RES.getRes("wq_1_png")),this.damping=0,this.bitmap.scaleX=.5,this.bitmap.scaleY=.5,this.displays=[this.bitmap]},i.prototype.updata=function(){t.prototype.updata.call(this)},i}(t.ZiDanBase);t.DingWeiZidan=i,__reflect(i.prototype,"zidan.DingWeiZidan")}(zidan||(zidan={}));var zidan;!function(t){var i=function(t){function i(i,e,n){var a=t.call(this,i,e,wuqi.WUQI_TYPE.PU_TONG)||this;return a.gz_time=1e4,a.sudu=2,a.initPT(),a.is_updata=!0,a.damping=0,a.suke=n,a}return __extends(i,t),i.prototype.initPT=function(){this.bitmap=new egret.Bitmap(RES.getRes("wq_3_png")),this.damping=0,this.bitmap.scaleX=.5,this.bitmap.scaleY=.5,this.displays=[this.bitmap]},i.prototype.updata=function(){if(t.prototype.updata.call(this),egret.getTimer()-this.mark_time>this.gz_time)return void(this.is_updata=!1);var i=Math.atan2(this.suke.position[1]-this.position[1],this.suke.position[0]-this.position[0])+.5*Math.PI,e=Math.sin(i)*this.sudu,n=Math.cos(i)*this.sudu;n=-1*n,this.angle=i,this.velocity=[e,n]},i}(t.ZiDanBase);t.GenZongZiDan=i,__reflect(i.prototype,"zidan.GenZongZiDan")}(zidan||(zidan={}));var zidan;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i,e,wuqi.WUQI_TYPE.PU_TONG)||this;return n.initPT(),n}return __extends(i,t),i.prototype.initPT=function(){this.bitmap=new egret.Bitmap(RES.getRes("wq_4_png")),this.damping=.8,this.bitmap.scaleX=.5,this.bitmap.scaleY=.5,this.displays=[this.bitmap]},i.prototype.updata=function(){t.prototype.updata.call(this)},i}(t.ZiDanBase);t.JianSuZiDan=i,__reflect(i.prototype,"zidan.JianSuZiDan")}(zidan||(zidan={}));var zidan;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i,e,wuqi.WUQI_TYPE.PU_TONG)||this;return n.initPT(),n.is_updata=!0,n}return __extends(i,t),i.prototype.initPT=function(){this.bitmap=new egret.Bitmap(RES.getRes("1-5_png")),this.damping=0,this.bitmap.scaleX=.5,this.bitmap.scaleY=.5,this.displays=[this.bitmap]},i.prototype.updata=function(){t.prototype.updata.call(this),this.force=[0,-1e-4]},i}(t.ZiDanBase);t.KaiHuaZiDan=i,__reflect(i.prototype,"zidan.KaiHuaZiDan")}(zidan||(zidan={}));var zidan;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i,e,wuqi.WUQI_TYPE.PU_TONG)||this;return n.initPT(),n.collNumber=1,n}return __extends(i,t),i.prototype.initPT=function(){this.bitmap=new egret.Bitmap(RES.getRes("lv_dian_png")),this.damping=0,this.displays=[this.bitmap]},i.prototype.updata=function(){t.prototype.updata.call(this)},i}(t.ZiDanBase);t.PuTongZiDan=i,__reflect(i.prototype,"zidan.PuTongZiDan")}(zidan||(zidan={}));var zidan;!function(t){var i=function(t){function i(i,e){var n=t.call(this,i,e,wuqi.WUQI_TYPE.PU_TONG)||this;return n.initPT(),n}return __extends(i,t),i.prototype.initPT=function(){this.bitmap=new egret.Bitmap(RES.getRes("wq_2_png")),this.damping=0,this.bitmap.scaleX=.5,this.bitmap.scaleY=.5,this.displays=[this.bitmap]},i.prototype.updata=function(){t.prototype.updata.call(this)},i}(t.ZiDanBase);t.ZhiSheZhiDan=i,__reflect(i.prototype,"zidan.ZhiSheZhiDan")}(zidan||(zidan={}));var shuke;!function(t){var i=function(t){function i(i){var e=t.call(this,i,egret.Point.create(scene.scene_anch_x+320,2100),GameConstant.ZHEN_YING.WO_JUN)||this;return e.fc_type=feichuan.FC_TYPE.SUKE,e.initSuKe(),e}return __extends(i,t),i.prototype.initYunTU=function(){this.yun_tu=[[1,2,2,2,3]]},i.prototype.initSuKe=function(){this.initYunTU(),this.initPro(this.yun_tu)},i.prototype.updataPos=function(){t.prototype.updataPos.call(this)},i}(feichuan.FeiChuanBase);t.ShuKe=i,__reflect(i.prototype,"shuke.ShuKe")}(shuke||(shuke={}));